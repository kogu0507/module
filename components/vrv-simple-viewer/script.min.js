import{VerovioManager as e}from"https://cdn.jsdelivr.net/gh/kogu0507/module@v2.4.3/verovio/verovio-manager.min.js";let scoreDefPresets={treble:"<staffGrp><staffDef n='1' lines='5' clef.shape='G' clef.line='2'/></staffGrp>",bass:"<staffGrp><staffDef n='1' lines='5' clef.shape='F' clef.line='4'/></staffGrp>",grand:`<staffGrp>
             <staffDef n='1' lines='5' clef.shape='G' clef.line='2'/>
             <staffDef n='2' lines='5' clef.shape='F' clef.line='4'/>
           </staffGrp>`,alto:"<staffGrp><staffDef n='1' lines='5' clef.shape='C' clef.line='3'/></staffGrp>",tenor:"<staffGrp><staffDef n='1' lines='5' clef.shape='C' clef.line='4'/></staffGrp>"},defaultOptions={adjustPageHeight:!0,adjustPageWidth:!0,breaks:"encoded",spacingStaff:5,spacingSystem:15,footer:"none",svgViewBox:!0,pageMarginTop:0,pageMarginRight:0,pageMarginBottom:0,pageMarginLeft:0};(async()=>{let t=new e;await t.initialize();let a=document.querySelectorAll(".vrv-simple-viewer");a.forEach(async(e,a)=>{e.id||(e.id=`vrv-viewer-${a}`);let i=Array.from(e.querySelectorAll('script[type="application/mei+xml"][data-mei-section="content"]')),s=document.createElement("div");s.className="vrv-loading",s.textContent="Loading score...",e.appendChild(s);try{let r=e.dataset.keySignature||"0",n=e.dataset.meter?e.dataset.meter:`count='${e.dataset.meterCount||4}' unit='${e.dataset.meterUnit||4}'`,f=(e.dataset.scoreDefPreset||"").split(",").map(e=>e.trim()).filter(Boolean),o=f.map(e=>scoreDefPresets[e]||"").join(""),l=e.dataset.tempo?`<tempo midi.bpm='${e.dataset.tempo}'/>`:"",c=`<mei xmlns="http://www.music-encoding.org/ns/mei" meiversion="5.1">
  <meiHead><musicMeta><keySig sig="${r}"/><timeSig ${n}/>${l}</musicMeta></meiHead>
<music><body><mdiv><score>
`,m=`<scoreDef keysig="${r}" ${n}>`,p="";i.forEach(e=>{p+=e.textContent.trim()+"\n"});let d=c+m+o+"</scoreDef>\n<section>\n"+p+"</section></score></mdiv></body></music></mei>",g=new Blob([d],{type:"application/xml"}),v=URL.createObjectURL(g);t.setRenderOptions(defaultOptions),await t.displaySvgFromUrl(v,e.id),console.log(d),s.remove(),URL.revokeObjectURL(v)}catch(u){s.remove(),e.innerHTML=`<div class="vrv-error">Error: ${u.message}</div>`,console.error(u)}})})();